matching_separable_simuls
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Install

``` sh
pip install matching_separable_simuls
```

## summary

The package reads the marriage patterns from the Choo and Siow 2006
*Journal of Political Economy* paper for the non-reform states of the
1970 wave. It fits a parsimonious homoskedastic logit model. Then it
generates `S` datasets from the fitted model, and it uses them to test
the estimation methods presented in Galichon-Salani√© 2022.

## reading the data


    The data has 25 types of men and 25 types of women.

We reshape the variance-covariance matrix and we normalize the data to a
unit total mass of households.

``` python
# the number of households in the population
n_households_pop = np.sum(nx) + np.sum(my) - np.sum(muxy)

mus = Matching(muxy, nx, my)
mus_norm = normalize_mus(mus, n_households_pop)

varmus_norm = reshape_varcov(varmus, n_types_men, n_types_women, n_households_pop)
```

## fitting a basic model

First we need to generate some basis functions. First we
quantile-transform the margins; then we generate orthogonal polynomials
on `[0,1]`. We also create variables `1(x=y)` and `max(x-y, 0)`.

``` python
xdeg = 2
ydeg = 2
base_functions = generate_bases(nx, my, xdeg, ydeg)
n_bases = base_functions.shape[-1]
print(f"We created {n_bases} bases")
for i_base in range(n_bases):
    print(f"   here is base {i_base}:\n")
    print(base_functions[:, :, i_base])
    print("\n")
```

    We created 7 bases
       here is base 0:

    [[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      1.]]


       here is base 1:

    [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0.
      0.]
     [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
      0.]]


       here is base 2:

    [[0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04
      0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08
      0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12
      0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2  0.16
      0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.   0.  ]
     [0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24 0.2
      0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.   0.  ]
     [0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28 0.24
      0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.   0.  ]
     [0.8  0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32 0.28
      0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.   0.  ]
     [0.84 0.8  0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36 0.32
      0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.   0.  ]
     [0.88 0.84 0.8  0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4  0.36
      0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.   0.  ]
     [0.92 0.88 0.84 0.8  0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44 0.4
      0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.   0.  ]
     [0.96 0.92 0.88 0.84 0.8  0.76 0.72 0.68 0.64 0.6  0.56 0.52 0.48 0.44
      0.4  0.36 0.32 0.28 0.24 0.2  0.16 0.12 0.08 0.04 0.  ]]


       here is base 3:

    [[ 0.85207101  0.78106509  0.71005917  0.63905325  0.56804734  0.49704142
       0.4260355   0.35502959  0.28402367  0.21301775  0.14201183  0.07100592
       0.         -0.14201183 -0.07100592 -0.35502959 -0.4260355  -0.71005917
      -0.56804734 -0.63905325 -0.85207101 -0.49704142 -0.78106509 -0.28402367
      -0.21301775]
     [ 0.78106509  0.71597633  0.65088757  0.58579882  0.52071006  0.4556213
       0.39053254  0.32544379  0.26035503  0.19526627  0.13017751  0.06508876
       0.         -0.13017751 -0.06508876 -0.32544379 -0.39053254 -0.65088757
      -0.52071006 -0.58579882 -0.78106509 -0.4556213  -0.71597633 -0.26035503
      -0.19526627]
     [ 0.71005917  0.65088757  0.59171598  0.53254438  0.47337278  0.41420118
       0.35502959  0.29585799  0.23668639  0.17751479  0.1183432   0.0591716
       0.         -0.1183432  -0.0591716  -0.29585799 -0.35502959 -0.59171598
      -0.47337278 -0.53254438 -0.71005917 -0.41420118 -0.65088757 -0.23668639
      -0.17751479]
     [ 0.63905325  0.58579882  0.53254438  0.47928994  0.4260355   0.37278107
       0.31952663  0.26627219  0.21301775  0.15976331  0.10650888  0.05325444
       0.         -0.10650888 -0.05325444 -0.26627219 -0.31952663 -0.53254438
      -0.4260355  -0.47928994 -0.63905325 -0.37278107 -0.58579882 -0.21301775
      -0.15976331]
     [ 0.56804734  0.52071006  0.47337278  0.4260355   0.37869822  0.33136095
       0.28402367  0.23668639  0.18934911  0.14201183  0.09467456  0.04733728
       0.         -0.09467456 -0.04733728 -0.23668639 -0.28402367 -0.47337278
      -0.37869822 -0.4260355  -0.56804734 -0.33136095 -0.52071006 -0.18934911
      -0.14201183]
     [ 0.49704142  0.4556213   0.41420118  0.37278107  0.33136095  0.28994083
       0.24852071  0.20710059  0.16568047  0.12426036  0.08284024  0.04142012
       0.         -0.08284024 -0.04142012 -0.20710059 -0.24852071 -0.41420118
      -0.33136095 -0.37278107 -0.49704142 -0.28994083 -0.4556213  -0.16568047
      -0.12426036]
     [ 0.4260355   0.39053254  0.35502959  0.31952663  0.28402367  0.24852071
       0.21301775  0.17751479  0.14201183  0.10650888  0.07100592  0.03550296
       0.         -0.07100592 -0.03550296 -0.17751479 -0.21301775 -0.35502959
      -0.28402367 -0.31952663 -0.4260355  -0.24852071 -0.39053254 -0.14201183
      -0.10650888]
     [ 0.35502959  0.32544379  0.29585799  0.26627219  0.23668639  0.20710059
       0.17751479  0.14792899  0.1183432   0.0887574   0.0591716   0.0295858
       0.         -0.0591716  -0.0295858  -0.14792899 -0.17751479 -0.29585799
      -0.23668639 -0.26627219 -0.35502959 -0.20710059 -0.32544379 -0.1183432
      -0.0887574 ]
     [ 0.28402367  0.26035503  0.23668639  0.21301775  0.18934911  0.16568047
       0.14201183  0.1183432   0.09467456  0.07100592  0.04733728  0.02366864
       0.         -0.04733728 -0.02366864 -0.1183432  -0.14201183 -0.23668639
      -0.18934911 -0.21301775 -0.28402367 -0.16568047 -0.26035503 -0.09467456
      -0.07100592]
     [ 0.21301775  0.19526627  0.17751479  0.15976331  0.14201183  0.12426036
       0.10650888  0.0887574   0.07100592  0.05325444  0.03550296  0.01775148
       0.         -0.03550296 -0.01775148 -0.0887574  -0.10650888 -0.17751479
      -0.14201183 -0.15976331 -0.21301775 -0.12426036 -0.19526627 -0.07100592
      -0.05325444]
     [ 0.14201183  0.13017751  0.1183432   0.10650888  0.09467456  0.08284024
       0.07100592  0.0591716   0.04733728  0.03550296  0.02366864  0.01183432
       0.         -0.02366864 -0.01183432 -0.0591716  -0.07100592 -0.1183432
      -0.09467456 -0.10650888 -0.14201183 -0.08284024 -0.13017751 -0.04733728
      -0.03550296]
     [ 0.07100592  0.06508876  0.0591716   0.05325444  0.04733728  0.04142012
       0.03550296  0.0295858   0.02366864  0.01775148  0.01183432  0.00591716
       0.         -0.01183432 -0.00591716 -0.0295858  -0.03550296 -0.0591716
      -0.04733728 -0.05325444 -0.07100592 -0.04142012 -0.06508876 -0.02366864
      -0.01775148]
     [ 0.          0.          0.          0.          0.          0.
       0.          0.          0.          0.          0.          0.
       0.         -0.         -0.         -0.         -0.         -0.
      -0.         -0.         -0.         -0.         -0.         -0.
      -0.        ]
     [-0.07100592 -0.06508876 -0.0591716  -0.05325444 -0.04733728 -0.04142012
      -0.03550296 -0.0295858  -0.02366864 -0.01775148 -0.01183432 -0.00591716
      -0.          0.01183432  0.00591716  0.0295858   0.03550296  0.0591716
       0.04733728  0.05325444  0.07100592  0.04142012  0.06508876  0.02366864
       0.01775148]
     [-0.14201183 -0.13017751 -0.1183432  -0.10650888 -0.09467456 -0.08284024
      -0.07100592 -0.0591716  -0.04733728 -0.03550296 -0.02366864 -0.01183432
      -0.          0.02366864  0.01183432  0.0591716   0.07100592  0.1183432
       0.09467456  0.10650888  0.14201183  0.08284024  0.13017751  0.04733728
       0.03550296]
     [-0.21301775 -0.19526627 -0.17751479 -0.15976331 -0.14201183 -0.12426036
      -0.10650888 -0.0887574  -0.07100592 -0.05325444 -0.03550296 -0.01775148
      -0.          0.03550296  0.01775148  0.0887574   0.10650888  0.17751479
       0.14201183  0.15976331  0.21301775  0.12426036  0.19526627  0.07100592
       0.05325444]
     [-0.35502959 -0.32544379 -0.29585799 -0.26627219 -0.23668639 -0.20710059
      -0.17751479 -0.14792899 -0.1183432  -0.0887574  -0.0591716  -0.0295858
      -0.          0.0591716   0.0295858   0.14792899  0.17751479  0.29585799
       0.23668639  0.26627219  0.35502959  0.20710059  0.32544379  0.1183432
       0.0887574 ]
     [-0.4260355  -0.39053254 -0.35502959 -0.31952663 -0.28402367 -0.24852071
      -0.21301775 -0.17751479 -0.14201183 -0.10650888 -0.07100592 -0.03550296
      -0.          0.07100592  0.03550296  0.17751479  0.21301775  0.35502959
       0.28402367  0.31952663  0.4260355   0.24852071  0.39053254  0.14201183
       0.10650888]
     [-0.63905325 -0.58579882 -0.53254438 -0.47928994 -0.4260355  -0.37278107
      -0.31952663 -0.26627219 -0.21301775 -0.15976331 -0.10650888 -0.05325444
      -0.          0.10650888  0.05325444  0.26627219  0.31952663  0.53254438
       0.4260355   0.47928994  0.63905325  0.37278107  0.58579882  0.21301775
       0.15976331]
     [-0.56804734 -0.52071006 -0.47337278 -0.4260355  -0.37869822 -0.33136095
      -0.28402367 -0.23668639 -0.18934911 -0.14201183 -0.09467456 -0.04733728
      -0.          0.09467456  0.04733728  0.23668639  0.28402367  0.47337278
       0.37869822  0.4260355   0.56804734  0.33136095  0.52071006  0.18934911
       0.14201183]
     [-0.78106509 -0.71597633 -0.65088757 -0.58579882 -0.52071006 -0.4556213
      -0.39053254 -0.32544379 -0.26035503 -0.19526627 -0.13017751 -0.06508876
      -0.          0.13017751  0.06508876  0.32544379  0.39053254  0.65088757
       0.52071006  0.58579882  0.78106509  0.4556213   0.71597633  0.26035503
       0.19526627]
     [-0.71005917 -0.65088757 -0.59171598 -0.53254438 -0.47337278 -0.41420118
      -0.35502959 -0.29585799 -0.23668639 -0.17751479 -0.1183432  -0.0591716
      -0.          0.1183432   0.0591716   0.29585799  0.35502959  0.59171598
       0.47337278  0.53254438  0.71005917  0.41420118  0.65088757  0.23668639
       0.17751479]
     [-0.85207101 -0.78106509 -0.71005917 -0.63905325 -0.56804734 -0.49704142
      -0.4260355  -0.35502959 -0.28402367 -0.21301775 -0.14201183 -0.07100592
      -0.          0.14201183  0.07100592  0.35502959  0.4260355   0.71005917
       0.56804734  0.63905325  0.85207101  0.49704142  0.78106509  0.28402367
       0.21301775]
     [-0.49704142 -0.4556213  -0.41420118 -0.37278107 -0.33136095 -0.28994083
      -0.24852071 -0.20710059 -0.16568047 -0.12426036 -0.08284024 -0.04142012
      -0.          0.08284024  0.04142012  0.20710059  0.24852071  0.41420118
       0.33136095  0.37278107  0.49704142  0.28994083  0.4556213   0.16568047
       0.12426036]
     [-0.28402367 -0.26035503 -0.23668639 -0.21301775 -0.18934911 -0.16568047
      -0.14201183 -0.1183432  -0.09467456 -0.07100592 -0.04733728 -0.02366864
      -0.          0.04733728  0.02366864  0.1183432   0.14201183  0.23668639
       0.18934911  0.21301775  0.28402367  0.16568047  0.26035503  0.09467456
       0.07100592]]


       here is base 4:

    [[ 0.71825216  0.52981338  0.35776058  0.20209376  0.06281293 -0.06008193
      -0.16659081 -0.2567137  -0.33045061 -0.38780155 -0.4287665  -0.45334547
      -0.46153846 -0.4287665  -0.45334547 -0.2567137  -0.16659081  0.35776058
       0.06281293  0.20209376  0.71825216 -0.06008193  0.52981338 -0.33045061
      -0.38780155]
     [ 0.65839782  0.48566227  0.3279472   0.18525262  0.05757852 -0.0550751
      -0.15270824 -0.23532089 -0.30291306 -0.35548475 -0.39303596 -0.41556668
      -0.42307692 -0.39303596 -0.41556668 -0.23532089 -0.15270824  0.3279472
       0.05757852  0.18525262  0.65839782 -0.0550751   0.48566227 -0.30291306
      -0.35548475]
     [ 0.59854347  0.44151115  0.29813382  0.16841147  0.05234411 -0.05006827
      -0.13882567 -0.21392808 -0.27537551 -0.32316796 -0.35730542 -0.37778789
      -0.38461538 -0.35730542 -0.37778789 -0.21392808 -0.13882567  0.29813382
       0.05234411  0.16841147  0.59854347 -0.05006827  0.44151115 -0.27537551
      -0.32316796]
     [ 0.53868912  0.39736004  0.26832044  0.15157032  0.0471097  -0.04506145
      -0.1249431  -0.19253528 -0.24783796 -0.29085116 -0.32157487 -0.3400091
      -0.34615385 -0.32157487 -0.3400091  -0.19253528 -0.1249431   0.26832044
       0.0471097   0.15157032  0.53868912 -0.04506145  0.39736004 -0.24783796
      -0.29085116]
     [ 0.47883477  0.35320892  0.23850706  0.13472918  0.04187528 -0.04005462
      -0.11106054 -0.17114247 -0.22030041 -0.25853437 -0.28584433 -0.30223031
      -0.30769231 -0.28584433 -0.30223031 -0.17114247 -0.11106054  0.23850706
       0.04187528  0.13472918  0.47883477 -0.04005462  0.35320892 -0.22030041
      -0.25853437]
     [ 0.41898043  0.30905781  0.20869367  0.11788803  0.03664087 -0.03504779
      -0.09717797 -0.14974966 -0.19276286 -0.22621757 -0.25011379 -0.26445152
      -0.26923077 -0.25011379 -0.26445152 -0.14974966 -0.09717797  0.20869367
       0.03664087  0.11788803  0.41898043 -0.03504779  0.30905781 -0.19276286
      -0.22621757]
     [ 0.35912608  0.26490669  0.17888029  0.10104688  0.03140646 -0.03004096
      -0.0832954  -0.12835685 -0.16522531 -0.19390077 -0.21438325 -0.22667274
      -0.23076923 -0.21438325 -0.22667274 -0.12835685 -0.0832954   0.17888029
       0.03140646  0.10104688  0.35912608 -0.03004096  0.26490669 -0.16522531
      -0.19390077]
     [ 0.29927173  0.22075558  0.14906691  0.08420574  0.02617205 -0.02503414
      -0.06941284 -0.10696404 -0.13768776 -0.16158398 -0.17865271 -0.18889395
      -0.19230769 -0.17865271 -0.18889395 -0.10696404 -0.06941284  0.14906691
       0.02617205  0.08420574  0.29927173 -0.02503414  0.22075558 -0.13768776
      -0.16158398]
     [ 0.23941739  0.17660446  0.11925353  0.06736459  0.02093764 -0.02002731
      -0.05553027 -0.08557123 -0.1101502  -0.12926718 -0.14292217 -0.15111516
      -0.15384615 -0.14292217 -0.15111516 -0.08557123 -0.05553027  0.11925353
       0.02093764  0.06736459  0.23941739 -0.02002731  0.17660446 -0.1101502
      -0.12926718]
     [ 0.17956304  0.13245335  0.08944015  0.05052344  0.01570323 -0.01502048
      -0.0416477  -0.06417843 -0.08261265 -0.09695039 -0.10719162 -0.11333637
      -0.11538462 -0.10719162 -0.11333637 -0.06417843 -0.0416477   0.08944015
       0.01570323  0.05052344  0.17956304 -0.01502048  0.13245335 -0.08261265
      -0.09695039]
     [ 0.11970869  0.08830223  0.05962676  0.03368229  0.01046882 -0.01001365
      -0.02776513 -0.04278562 -0.0550751  -0.06463359 -0.07146108 -0.07555758
      -0.07692308 -0.07146108 -0.07555758 -0.04278562 -0.02776513  0.05962676
       0.01046882  0.03368229  0.11970869 -0.01001365  0.08830223 -0.0550751
      -0.06463359]
     [ 0.05985435  0.04415112  0.02981338  0.01684115  0.00523441 -0.00500683
      -0.01388257 -0.02139281 -0.02753755 -0.0323168  -0.03573054 -0.03777879
      -0.03846154 -0.03573054 -0.03777879 -0.02139281 -0.01388257  0.02981338
       0.00523441  0.01684115  0.05985435 -0.00500683  0.04415112 -0.02753755
      -0.0323168 ]
     [ 0.          0.          0.          0.          0.         -0.
      -0.         -0.         -0.         -0.         -0.         -0.
      -0.         -0.         -0.         -0.         -0.          0.
       0.          0.          0.         -0.          0.         -0.
      -0.        ]
     [-0.05985435 -0.04415112 -0.02981338 -0.01684115 -0.00523441  0.00500683
       0.01388257  0.02139281  0.02753755  0.0323168   0.03573054  0.03777879
       0.03846154  0.03573054  0.03777879  0.02139281  0.01388257 -0.02981338
      -0.00523441 -0.01684115 -0.05985435  0.00500683 -0.04415112  0.02753755
       0.0323168 ]
     [-0.11970869 -0.08830223 -0.05962676 -0.03368229 -0.01046882  0.01001365
       0.02776513  0.04278562  0.0550751   0.06463359  0.07146108  0.07555758
       0.07692308  0.07146108  0.07555758  0.04278562  0.02776513 -0.05962676
      -0.01046882 -0.03368229 -0.11970869  0.01001365 -0.08830223  0.0550751
       0.06463359]
     [-0.17956304 -0.13245335 -0.08944015 -0.05052344 -0.01570323  0.01502048
       0.0416477   0.06417843  0.08261265  0.09695039  0.10719162  0.11333637
       0.11538462  0.10719162  0.11333637  0.06417843  0.0416477  -0.08944015
      -0.01570323 -0.05052344 -0.17956304  0.01502048 -0.13245335  0.08261265
       0.09695039]
     [-0.29927173 -0.22075558 -0.14906691 -0.08420574 -0.02617205  0.02503414
       0.06941284  0.10696404  0.13768776  0.16158398  0.17865271  0.18889395
       0.19230769  0.17865271  0.18889395  0.10696404  0.06941284 -0.14906691
      -0.02617205 -0.08420574 -0.29927173  0.02503414 -0.22075558  0.13768776
       0.16158398]
     [-0.35912608 -0.26490669 -0.17888029 -0.10104688 -0.03140646  0.03004096
       0.0832954   0.12835685  0.16522531  0.19390077  0.21438325  0.22667274
       0.23076923  0.21438325  0.22667274  0.12835685  0.0832954  -0.17888029
      -0.03140646 -0.10104688 -0.35912608  0.03004096 -0.26490669  0.16522531
       0.19390077]
     [-0.53868912 -0.39736004 -0.26832044 -0.15157032 -0.0471097   0.04506145
       0.1249431   0.19253528  0.24783796  0.29085116  0.32157487  0.3400091
       0.34615385  0.32157487  0.3400091   0.19253528  0.1249431  -0.26832044
      -0.0471097  -0.15157032 -0.53868912  0.04506145 -0.39736004  0.24783796
       0.29085116]
     [-0.47883477 -0.35320892 -0.23850706 -0.13472918 -0.04187528  0.04005462
       0.11106054  0.17114247  0.22030041  0.25853437  0.28584433  0.30223031
       0.30769231  0.28584433  0.30223031  0.17114247  0.11106054 -0.23850706
      -0.04187528 -0.13472918 -0.47883477  0.04005462 -0.35320892  0.22030041
       0.25853437]
     [-0.65839782 -0.48566227 -0.3279472  -0.18525262 -0.05757852  0.0550751
       0.15270824  0.23532089  0.30291306  0.35548475  0.39303596  0.41556668
       0.42307692  0.39303596  0.41556668  0.23532089  0.15270824 -0.3279472
      -0.05757852 -0.18525262 -0.65839782  0.0550751  -0.48566227  0.30291306
       0.35548475]
     [-0.59854347 -0.44151115 -0.29813382 -0.16841147 -0.05234411  0.05006827
       0.13882567  0.21392808  0.27537551  0.32316796  0.35730542  0.37778789
       0.38461538  0.35730542  0.37778789  0.21392808  0.13882567 -0.29813382
      -0.05234411 -0.16841147 -0.59854347  0.05006827 -0.44151115  0.27537551
       0.32316796]
     [-0.71825216 -0.52981338 -0.35776058 -0.20209376 -0.06281293  0.06008193
       0.16659081  0.2567137   0.33045061  0.38780155  0.4287665   0.45334547
       0.46153846  0.4287665   0.45334547  0.2567137   0.16659081 -0.35776058
      -0.06281293 -0.20209376 -0.71825216  0.06008193 -0.52981338  0.33045061
       0.38780155]
     [-0.41898043 -0.30905781 -0.20869367 -0.11788803 -0.03664087  0.03504779
       0.09717797  0.14974966  0.19276286  0.22621757  0.25011379  0.26445152
       0.26923077  0.25011379  0.26445152  0.14974966  0.09717797 -0.20869367
      -0.03664087 -0.11788803 -0.41898043  0.03504779 -0.30905781  0.19276286
       0.22621757]
     [-0.23941739 -0.17660446 -0.11925353 -0.06736459 -0.02093764  0.02002731
       0.05553027  0.08557123  0.1101502   0.12926718  0.14292217  0.15111516
       0.15384615  0.14292217  0.15111516  0.08557123  0.05553027 -0.11925353
      -0.02093764 -0.06736459 -0.23941739  0.02002731 -0.17660446  0.1101502
       0.12926718]]


       here is base 5:

    [[ 0.71825216  0.65839782  0.59854347  0.53868912  0.47883477  0.41898043
       0.35912608  0.29927173  0.23941739  0.17956304  0.11970869  0.05985435
       0.         -0.11970869 -0.05985435 -0.29927173 -0.35912608 -0.59854347
      -0.47883477 -0.53868912 -0.71825216 -0.41898043 -0.65839782 -0.23941739
      -0.17956304]
     [ 0.52981338  0.48566227  0.44151115  0.39736004  0.35320892  0.30905781
       0.26490669  0.22075558  0.17660446  0.13245335  0.08830223  0.04415112
       0.         -0.08830223 -0.04415112 -0.22075558 -0.26490669 -0.44151115
      -0.35320892 -0.39736004 -0.52981338 -0.30905781 -0.48566227 -0.17660446
      -0.13245335]
     [ 0.35776058  0.3279472   0.29813382  0.26832044  0.23850706  0.20869367
       0.17888029  0.14906691  0.11925353  0.08944015  0.05962676  0.02981338
       0.         -0.05962676 -0.02981338 -0.14906691 -0.17888029 -0.29813382
      -0.23850706 -0.26832044 -0.35776058 -0.20869367 -0.3279472  -0.11925353
      -0.08944015]
     [ 0.20209376  0.18525262  0.16841147  0.15157032  0.13472918  0.11788803
       0.10104688  0.08420574  0.06736459  0.05052344  0.03368229  0.01684115
       0.         -0.03368229 -0.01684115 -0.08420574 -0.10104688 -0.16841147
      -0.13472918 -0.15157032 -0.20209376 -0.11788803 -0.18525262 -0.06736459
      -0.05052344]
     [ 0.06281293  0.05757852  0.05234411  0.0471097   0.04187528  0.03664087
       0.03140646  0.02617205  0.02093764  0.01570323  0.01046882  0.00523441
       0.         -0.01046882 -0.00523441 -0.02617205 -0.03140646 -0.05234411
      -0.04187528 -0.0471097  -0.06281293 -0.03664087 -0.05757852 -0.02093764
      -0.01570323]
     [-0.06008193 -0.0550751  -0.05006827 -0.04506145 -0.04005462 -0.03504779
      -0.03004096 -0.02503414 -0.02002731 -0.01502048 -0.01001365 -0.00500683
      -0.          0.01001365  0.00500683  0.02503414  0.03004096  0.05006827
       0.04005462  0.04506145  0.06008193  0.03504779  0.0550751   0.02002731
       0.01502048]
     [-0.16659081 -0.15270824 -0.13882567 -0.1249431  -0.11106054 -0.09717797
      -0.0832954  -0.06941284 -0.05553027 -0.0416477  -0.02776513 -0.01388257
      -0.          0.02776513  0.01388257  0.06941284  0.0832954   0.13882567
       0.11106054  0.1249431   0.16659081  0.09717797  0.15270824  0.05553027
       0.0416477 ]
     [-0.2567137  -0.23532089 -0.21392808 -0.19253528 -0.17114247 -0.14974966
      -0.12835685 -0.10696404 -0.08557123 -0.06417843 -0.04278562 -0.02139281
      -0.          0.04278562  0.02139281  0.10696404  0.12835685  0.21392808
       0.17114247  0.19253528  0.2567137   0.14974966  0.23532089  0.08557123
       0.06417843]
     [-0.33045061 -0.30291306 -0.27537551 -0.24783796 -0.22030041 -0.19276286
      -0.16522531 -0.13768776 -0.1101502  -0.08261265 -0.0550751  -0.02753755
      -0.          0.0550751   0.02753755  0.13768776  0.16522531  0.27537551
       0.22030041  0.24783796  0.33045061  0.19276286  0.30291306  0.1101502
       0.08261265]
     [-0.38780155 -0.35548475 -0.32316796 -0.29085116 -0.25853437 -0.22621757
      -0.19390077 -0.16158398 -0.12926718 -0.09695039 -0.06463359 -0.0323168
      -0.          0.06463359  0.0323168   0.16158398  0.19390077  0.32316796
       0.25853437  0.29085116  0.38780155  0.22621757  0.35548475  0.12926718
       0.09695039]
     [-0.4287665  -0.39303596 -0.35730542 -0.32157487 -0.28584433 -0.25011379
      -0.21438325 -0.17865271 -0.14292217 -0.10719162 -0.07146108 -0.03573054
      -0.          0.07146108  0.03573054  0.17865271  0.21438325  0.35730542
       0.28584433  0.32157487  0.4287665   0.25011379  0.39303596  0.14292217
       0.10719162]
     [-0.45334547 -0.41556668 -0.37778789 -0.3400091  -0.30223031 -0.26445152
      -0.22667274 -0.18889395 -0.15111516 -0.11333637 -0.07555758 -0.03777879
      -0.          0.07555758  0.03777879  0.18889395  0.22667274  0.37778789
       0.30223031  0.3400091   0.45334547  0.26445152  0.41556668  0.15111516
       0.11333637]
     [-0.46153846 -0.42307692 -0.38461538 -0.34615385 -0.30769231 -0.26923077
      -0.23076923 -0.19230769 -0.15384615 -0.11538462 -0.07692308 -0.03846154
      -0.          0.07692308  0.03846154  0.19230769  0.23076923  0.38461538
       0.30769231  0.34615385  0.46153846  0.26923077  0.42307692  0.15384615
       0.11538462]
     [-0.45334547 -0.41556668 -0.37778789 -0.3400091  -0.30223031 -0.26445152
      -0.22667274 -0.18889395 -0.15111516 -0.11333637 -0.07555758 -0.03777879
      -0.          0.07555758  0.03777879  0.18889395  0.22667274  0.37778789
       0.30223031  0.3400091   0.45334547  0.26445152  0.41556668  0.15111516
       0.11333637]
     [-0.4287665  -0.39303596 -0.35730542 -0.32157487 -0.28584433 -0.25011379
      -0.21438325 -0.17865271 -0.14292217 -0.10719162 -0.07146108 -0.03573054
      -0.          0.07146108  0.03573054  0.17865271  0.21438325  0.35730542
       0.28584433  0.32157487  0.4287665   0.25011379  0.39303596  0.14292217
       0.10719162]
     [-0.38780155 -0.35548475 -0.32316796 -0.29085116 -0.25853437 -0.22621757
      -0.19390077 -0.16158398 -0.12926718 -0.09695039 -0.06463359 -0.0323168
      -0.          0.06463359  0.0323168   0.16158398  0.19390077  0.32316796
       0.25853437  0.29085116  0.38780155  0.22621757  0.35548475  0.12926718
       0.09695039]
     [-0.2567137  -0.23532089 -0.21392808 -0.19253528 -0.17114247 -0.14974966
      -0.12835685 -0.10696404 -0.08557123 -0.06417843 -0.04278562 -0.02139281
      -0.          0.04278562  0.02139281  0.10696404  0.12835685  0.21392808
       0.17114247  0.19253528  0.2567137   0.14974966  0.23532089  0.08557123
       0.06417843]
     [-0.16659081 -0.15270824 -0.13882567 -0.1249431  -0.11106054 -0.09717797
      -0.0832954  -0.06941284 -0.05553027 -0.0416477  -0.02776513 -0.01388257
      -0.          0.02776513  0.01388257  0.06941284  0.0832954   0.13882567
       0.11106054  0.1249431   0.16659081  0.09717797  0.15270824  0.05553027
       0.0416477 ]
     [ 0.20209376  0.18525262  0.16841147  0.15157032  0.13472918  0.11788803
       0.10104688  0.08420574  0.06736459  0.05052344  0.03368229  0.01684115
       0.         -0.03368229 -0.01684115 -0.08420574 -0.10104688 -0.16841147
      -0.13472918 -0.15157032 -0.20209376 -0.11788803 -0.18525262 -0.06736459
      -0.05052344]
     [ 0.06281293  0.05757852  0.05234411  0.0471097   0.04187528  0.03664087
       0.03140646  0.02617205  0.02093764  0.01570323  0.01046882  0.00523441
       0.         -0.01046882 -0.00523441 -0.02617205 -0.03140646 -0.05234411
      -0.04187528 -0.0471097  -0.06281293 -0.03664087 -0.05757852 -0.02093764
      -0.01570323]
     [ 0.52981338  0.48566227  0.44151115  0.39736004  0.35320892  0.30905781
       0.26490669  0.22075558  0.17660446  0.13245335  0.08830223  0.04415112
       0.         -0.08830223 -0.04415112 -0.22075558 -0.26490669 -0.44151115
      -0.35320892 -0.39736004 -0.52981338 -0.30905781 -0.48566227 -0.17660446
      -0.13245335]
     [ 0.35776058  0.3279472   0.29813382  0.26832044  0.23850706  0.20869367
       0.17888029  0.14906691  0.11925353  0.08944015  0.05962676  0.02981338
       0.         -0.05962676 -0.02981338 -0.14906691 -0.17888029 -0.29813382
      -0.23850706 -0.26832044 -0.35776058 -0.20869367 -0.3279472  -0.11925353
      -0.08944015]
     [ 0.71825216  0.65839782  0.59854347  0.53868912  0.47883477  0.41898043
       0.35912608  0.29927173  0.23941739  0.17956304  0.11970869  0.05985435
       0.         -0.11970869 -0.05985435 -0.29927173 -0.35912608 -0.59854347
      -0.47883477 -0.53868912 -0.71825216 -0.41898043 -0.65839782 -0.23941739
      -0.17956304]
     [-0.06008193 -0.0550751  -0.05006827 -0.04506145 -0.04005462 -0.03504779
      -0.03004096 -0.02503414 -0.02002731 -0.01502048 -0.01001365 -0.00500683
      -0.          0.01001365  0.00500683  0.02503414  0.03004096  0.05006827
       0.04005462  0.04506145  0.06008193  0.03504779  0.0550751   0.02002731
       0.01502048]
     [-0.33045061 -0.30291306 -0.27537551 -0.24783796 -0.22030041 -0.19276286
      -0.16522531 -0.13768776 -0.1101502  -0.08261265 -0.0550751  -0.02753755
      -0.          0.0550751   0.02753755  0.13768776  0.16522531  0.27537551
       0.22030041  0.24783796  0.33045061  0.19276286  0.30291306  0.1101502
       0.08261265]]


       here is base 6:

    [[ 0.60544974  0.44660551  0.30157382  0.17035468  0.05294808 -0.05064599
      -0.14042751 -0.21639648 -0.27855292 -0.32689682 -0.36142817 -0.38214698
      -0.38905325 -0.36142817 -0.38214698 -0.21639648 -0.14042751  0.30157382
       0.05294808  0.17035468  0.60544974 -0.05064599  0.44660551 -0.27855292
      -0.32689682]
     [ 0.44660551  0.32943524  0.2224537   0.12566087  0.03905676 -0.03735864
      -0.10358531 -0.15962326 -0.2054725  -0.24113301 -0.26660481 -0.28188789
      -0.28698225 -0.26660481 -0.28188789 -0.15962326 -0.10358531  0.2224537
       0.03905676  0.12566087  0.44660551 -0.03735864  0.32943524 -0.2054725
      -0.24113301]
     [ 0.30157382  0.2224537   0.15021358  0.08485347  0.02637338 -0.02522671
      -0.06994678 -0.10778684 -0.13874689 -0.16282693 -0.18002696 -0.19034698
      -0.19378698 -0.18002696 -0.19034698 -0.10778684 -0.06994678  0.15021358
       0.02637338  0.08485347  0.30157382 -0.02522671  0.2224537  -0.13874689
      -0.16282693]
     [ 0.17035468  0.12566087  0.08485347  0.0479325   0.01489794 -0.0142502
      -0.03951192 -0.06088722 -0.07837611 -0.09197857 -0.10169462 -0.10752425
      -0.10946746 -0.10169462 -0.10752425 -0.06088722 -0.03951192  0.08485347
       0.01489794  0.0479325   0.17035468 -0.0142502   0.12566087 -0.07837611
      -0.09197857]
     [ 0.05294808  0.03905676  0.02637338  0.01489794  0.00463044 -0.00442912
      -0.01228073 -0.01892441 -0.02436014 -0.02858793 -0.03160779 -0.0334197
      -0.03402367 -0.03160779 -0.0334197  -0.01892441 -0.01228073  0.02637338
       0.00463044  0.01489794  0.05294808 -0.00442912  0.03905676 -0.02436014
      -0.02858793]
     [-0.05064599 -0.03735864 -0.02522671 -0.0142502  -0.00442912  0.00423655
       0.01174679  0.01810161  0.023301    0.02734498  0.03023354  0.03196667
       0.03254438  0.03023354  0.03196667  0.01810161  0.01174679 -0.02522671
      -0.00442912 -0.0142502  -0.05064599  0.00423655 -0.03735864  0.023301
       0.02734498]
     [-0.14042751 -0.10358531 -0.06994678 -0.03951192 -0.01228073  0.01174679
       0.03257064  0.05019082  0.06460733  0.07582017  0.08382935  0.08863485
       0.09023669  0.08382935  0.08863485  0.05019082  0.03257064 -0.06994678
      -0.01228073 -0.03951192 -0.14042751  0.01174679 -0.10358531  0.06460733
       0.07582017]
     [-0.21639648 -0.15962326 -0.10778684 -0.06088722 -0.01892441  0.01810161
       0.05019082  0.07734323  0.09955884  0.11683765  0.12917965  0.13658485
       0.13905325  0.12917965  0.13658485  0.07734323  0.05019082 -0.10778684
      -0.01892441 -0.06088722 -0.21639648  0.01810161 -0.15962326  0.09955884
       0.11683765]
     [-0.27855292 -0.2054725  -0.13874689 -0.07837611 -0.02436014  0.023301
       0.06460733  0.09955884  0.12815553  0.1503974   0.16628444  0.17581667
       0.17899408  0.16628444  0.17581667  0.09955884  0.06460733 -0.13874689
      -0.02436014 -0.07837611 -0.27855292  0.023301   -0.2054725   0.12815553
       0.1503974 ]
     [-0.32689682 -0.24113301 -0.16282693 -0.09197857 -0.02858793  0.02734498
       0.07582017  0.11683765  0.1503974   0.17649942  0.19514373  0.20633031
       0.21005917  0.19514373  0.20633031  0.11683765  0.07582017 -0.16282693
      -0.02858793 -0.09197857 -0.32689682  0.02734498 -0.24113301  0.1503974
       0.17649942]
     [-0.36142817 -0.26660481 -0.18002696 -0.10169462 -0.03160779  0.03023354
       0.08382935  0.12917965  0.16628444  0.19514373  0.2157575   0.22812577
       0.23224852  0.2157575   0.22812577  0.12917965  0.08382935 -0.18002696
      -0.03160779 -0.10169462 -0.36142817  0.03023354 -0.26660481  0.16628444
       0.19514373]
     [-0.38214698 -0.28188789 -0.19034698 -0.10752425 -0.0334197   0.03196667
       0.08863485  0.13658485  0.17581667  0.20633031  0.22812577  0.24120304
       0.24556213  0.22812577  0.24120304  0.13658485  0.08863485 -0.19034698
      -0.0334197  -0.10752425 -0.38214698  0.03196667 -0.28188789  0.17581667
       0.20633031]
     [-0.38905325 -0.28698225 -0.19378698 -0.10946746 -0.03402367  0.03254438
       0.09023669  0.13905325  0.17899408  0.21005917  0.23224852  0.24556213
       0.25        0.23224852  0.24556213  0.13905325  0.09023669 -0.19378698
      -0.03402367 -0.10946746 -0.38905325  0.03254438 -0.28698225  0.17899408
       0.21005917]
     [-0.38214698 -0.28188789 -0.19034698 -0.10752425 -0.0334197   0.03196667
       0.08863485  0.13658485  0.17581667  0.20633031  0.22812577  0.24120304
       0.24556213  0.22812577  0.24120304  0.13658485  0.08863485 -0.19034698
      -0.0334197  -0.10752425 -0.38214698  0.03196667 -0.28188789  0.17581667
       0.20633031]
     [-0.36142817 -0.26660481 -0.18002696 -0.10169462 -0.03160779  0.03023354
       0.08382935  0.12917965  0.16628444  0.19514373  0.2157575   0.22812577
       0.23224852  0.2157575   0.22812577  0.12917965  0.08382935 -0.18002696
      -0.03160779 -0.10169462 -0.36142817  0.03023354 -0.26660481  0.16628444
       0.19514373]
     [-0.32689682 -0.24113301 -0.16282693 -0.09197857 -0.02858793  0.02734498
       0.07582017  0.11683765  0.1503974   0.17649942  0.19514373  0.20633031
       0.21005917  0.19514373  0.20633031  0.11683765  0.07582017 -0.16282693
      -0.02858793 -0.09197857 -0.32689682  0.02734498 -0.24113301  0.1503974
       0.17649942]
     [-0.21639648 -0.15962326 -0.10778684 -0.06088722 -0.01892441  0.01810161
       0.05019082  0.07734323  0.09955884  0.11683765  0.12917965  0.13658485
       0.13905325  0.12917965  0.13658485  0.07734323  0.05019082 -0.10778684
      -0.01892441 -0.06088722 -0.21639648  0.01810161 -0.15962326  0.09955884
       0.11683765]
     [-0.14042751 -0.10358531 -0.06994678 -0.03951192 -0.01228073  0.01174679
       0.03257064  0.05019082  0.06460733  0.07582017  0.08382935  0.08863485
       0.09023669  0.08382935  0.08863485  0.05019082  0.03257064 -0.06994678
      -0.01228073 -0.03951192 -0.14042751  0.01174679 -0.10358531  0.06460733
       0.07582017]
     [ 0.17035468  0.12566087  0.08485347  0.0479325   0.01489794 -0.0142502
      -0.03951192 -0.06088722 -0.07837611 -0.09197857 -0.10169462 -0.10752425
      -0.10946746 -0.10169462 -0.10752425 -0.06088722 -0.03951192  0.08485347
       0.01489794  0.0479325   0.17035468 -0.0142502   0.12566087 -0.07837611
      -0.09197857]
     [ 0.05294808  0.03905676  0.02637338  0.01489794  0.00463044 -0.00442912
      -0.01228073 -0.01892441 -0.02436014 -0.02858793 -0.03160779 -0.0334197
      -0.03402367 -0.03160779 -0.0334197  -0.01892441 -0.01228073  0.02637338
       0.00463044  0.01489794  0.05294808 -0.00442912  0.03905676 -0.02436014
      -0.02858793]
     [ 0.44660551  0.32943524  0.2224537   0.12566087  0.03905676 -0.03735864
      -0.10358531 -0.15962326 -0.2054725  -0.24113301 -0.26660481 -0.28188789
      -0.28698225 -0.26660481 -0.28188789 -0.15962326 -0.10358531  0.2224537
       0.03905676  0.12566087  0.44660551 -0.03735864  0.32943524 -0.2054725
      -0.24113301]
     [ 0.30157382  0.2224537   0.15021358  0.08485347  0.02637338 -0.02522671
      -0.06994678 -0.10778684 -0.13874689 -0.16282693 -0.18002696 -0.19034698
      -0.19378698 -0.18002696 -0.19034698 -0.10778684 -0.06994678  0.15021358
       0.02637338  0.08485347  0.30157382 -0.02522671  0.2224537  -0.13874689
      -0.16282693]
     [ 0.60544974  0.44660551  0.30157382  0.17035468  0.05294808 -0.05064599
      -0.14042751 -0.21639648 -0.27855292 -0.32689682 -0.36142817 -0.38214698
      -0.38905325 -0.36142817 -0.38214698 -0.21639648 -0.14042751  0.30157382
       0.05294808  0.17035468  0.60544974 -0.05064599  0.44660551 -0.27855292
      -0.32689682]
     [-0.05064599 -0.03735864 -0.02522671 -0.0142502  -0.00442912  0.00423655
       0.01174679  0.01810161  0.023301    0.02734498  0.03023354  0.03196667
       0.03254438  0.03023354  0.03196667  0.01810161  0.01174679 -0.02522671
      -0.00442912 -0.0142502  -0.05064599  0.00423655 -0.03735864  0.023301
       0.02734498]
     [-0.27855292 -0.2054725  -0.13874689 -0.07837611 -0.02436014  0.023301
       0.06460733  0.09955884  0.12815553  0.1503974   0.16628444  0.17581667
       0.17899408  0.16628444  0.17581667  0.09955884  0.06460733 -0.13874689
      -0.02436014 -0.07837611 -0.27855292  0.023301   -0.2054725   0.12815553
       0.1503974 ]]

### we save the data and the bases we generated

``` python
with open(data_dir / "mus_norm.pkl", "wb") as f:
    pickle.dump(mus_norm, f)
with open(data_dir / "varmus_norm.pkl", "wb") as f:
    pickle.dump(varmus_norm, f)
with open(data_dir / "base_functions.pkl", "wb") as f:
    pickle.dump(base_functions, f)
```

## generating artificial datasets

## fitting a homoskedastic logit model

## fitting a nested logit model
